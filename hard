from sympy import Matrix


def hard(B: Matrix):
    N = 4
    A = Matrix([
        [
            1 if max(v*v for v in [x-i, y-j, z-k]) <= 1 else 0
            for x in range(1-N, N) for y in range(1-N, N) for z in range(1-N, N) if x+y+z == 0 and x != N-1
        ]
        for i in range(1-N, N) for j in range(1-N, N) for k in range(1-N, N) if i+j+k == 0 and i != N-1
    ])
    return A.inv() * (-B) % 2
